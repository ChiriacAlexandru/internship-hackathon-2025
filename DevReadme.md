# üß© AI Code Review Assistant ‚Äî Project Overview (Semi-Technical Description)

## üéØ Project Purpose

The **AI Code Review Assistant** is a web platform designed to improve software development quality and collaboration inside teams using **AI-powered code analysis** that runs **entirely locally** ‚Äî ensuring privacy, speed, and full data ownership.

The project aims to assist **developers**, **product owners**, and **administrators** by automating code reviews, generating technical and non-technical reports, and enforcing internal coding standards.

The platform uses a **locally hosted AI model** (via [Ollama](https://ollama.ai)) to review code, detect issues, and provide improvement recommendations without sending any data to external APIs.

---

## üë• User Roles and Responsibilities

| Role                      | Purpose                                                          | Key Capabilities                                                                                                                                                                     |
| ------------------------- | ---------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| üßë‚Äçüíº **Admin**              | Maintains the platform and global policies.                      | - Creates user accounts (Developers & Product Owners)<br>- Defines mandatory coding rules and guidelines<br>- Assigns projects and members<br>- Views aggregated analytics           |
| üë®‚Äçüíª **Developer**          | Uses the system to review code and improve quality.              | - Uploads or connects Git repositories<br>- Runs AI code reviews locally<br>- Mandatory rules are automatically checked<br>- Can request additional feedback or auto-fix suggestions |
| üß† **Product Owner (PO)** | Monitors project progress and quality from a non-technical view. | - Receives plain-language summaries generated by the AI<br>- Reviews progress vs. timeline<br>- Sees code quality trends and risk areas                                              |

---

## üí° How the Platform Works (Concept Flow)

1. **Admin setup**  
   The Admin defines a set of _mandatory rules_ (e.g. ‚Äúno eval statements‚Äù, ‚Äúfunctions must have docstrings‚Äù, ‚Äúfollow PEP8/ESLint‚Äù).  
   These rules are stored in the database and applied to every review.

2. **Developer workflow**  
   The Developer pushes or uploads code ‚Üí the backend automatically:

   - Extracts the changed lines or full code (using Git diff or upload).
   - Runs the rules engine for mandatory checks.
   - Sends the code to a **local AI model (Ollama)** for deep review.
   - Merges both static (rules) and AI findings.
   - Optionally applies AI-generated ‚Äúauto-fix‚Äù patches.

3. **Product Owner insights**  
   The Product Owner receives a non-technical report with:

   - A quality score (good / fair / poor)
   - Key risk areas (e.g. performance, security, maintainability)
   - Estimated progress vs. project milestones
   - A human-friendly summary written by the AI in simple language.

4. **All data stays local**  
   Reviews, rules, and code never leave the local environment.  
   The AI model runs inside the developer‚Äôs or organization‚Äôs server.

---

## üß† AI Interaction

- The backend communicates with **Ollama** through `http://localhost:11434/api/chat`.
- The model used is **DeepSeek-Coder** or **CodeLlama**, both fine-tuned for code analysis.
- The backend sends structured prompts like:  
  ‚ÄúAnalyze the following code and return a JSON array of findings with category, severity, title, explanation, recommendation, and effort_minutes.‚Äù
- The response is parsed into structured data and stored in PostgreSQL.

---

## ‚öôÔ∏è System Goals (High-Level)

1. **Automated Code Review**
   - Detect bugs, performance issues, security problems, and style violations.
2. **Rule Enforcement**
   - Ensure every developer follows admin-defined coding guidelines.
3. **Incremental Review**
   - Only analyze code that has changed (Git diff).
4. **Automatic Fixes (optional)**
   - Apply AI-suggested changes automatically.
5. **Cost & Resource Tracking**
   - Monitor local resource usage: time, prompt size, latency.
6. **Human-Readable Reporting**
   - Generate summaries understandable by non-technical staff (PO, managers).

---

## üß± Backend Implementation Objectives (for Codex)

Codex should generate the backend following this logic:

1. **Environment & Tools**

   - Stack: **Node.js (Express.js)**, **PostgreSQL (raw SQL via pg)**, **Ollama**.
   - Environment variables for DB, AI, and JWT auth.

2. **Core Modules**

   - **ollamaSvc** ‚Äî handles AI prompts and responses.
   - **ruleEngine** ‚Äî enforces admin rules before running AI.
   - **diffSvc** ‚Äî extracts modified code segments from Git.
   - **costTracker** ‚Äî logs usage (prompt size, latency).
   - **patchSvc** ‚Äî applies unified diff patches for auto-fixes.

3. **API Routes**

   - `/auth` ‚Üí authentication (JWT)
   - `/users` ‚Üí manage users and roles
   - `/projects` ‚Üí manage projects
   - `/rules` ‚Üí CRUD for coding rules
   - `/review` ‚Üí main AI review endpoint
   - `/reports` ‚Üí PO summary endpoint

4. **Database**

   - Tables: `users`, `projects`, `rules`, `reviews`, `findings`, `token_usage`
   - Each `review` stores both static rule violations and AI findings.

5. **Security**

   - JWT-based authentication
   - Role-based access control (Admin, Dev, PO)
   - No external data transfer ‚Äî local AI only.

6. **Outputs**
   - Structured JSON findings per file or function.
   - Severity levels (low / medium / high / critical).
   - Human-friendly recommendations.
   - Optional unified diff patch for auto-fix.

---

## üìä Example Outputs

### Developer Review Example

```json
[
  {
    "file": "src/utils/math.js",
    "line_start": 12,
    "line_end": 16,
    "category": "performance",
    "severity": "medium",
    "title": "Inefficient loop concatenation",
    "explanation": "String concatenation inside loops can be slow.",
    "recommendation": "Use array join or template literals instead.",
    "effort_minutes": 5
  }
]
```
